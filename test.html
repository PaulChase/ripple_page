<!DOCTYPE html>
<html>
	<head>
		<base target="_top" />
		<!--INCLUDE REQUIRED EXTERNAL JAVASCRIPT AND CSS LIBRARIES-->
		<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
		<script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
		<script src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap4.min.js"></script>
		<link
			rel="stylesheet"
			type="text/css"
			href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="https://cdn.datatables.net/1.10.23/css/dataTables.bootstrap4.min.css"
		/>
		<!--INCLUDE JavaScript.html FILE-->

		<link rel="stylesheet" href="/dist/app.css" />
	</head>

	<body>
		<div class="container">
			<br />
			<div class="row">
				<table id="data-table" class="table table-striped table-sm table-hover table-bordered">
					<!-- TABLE DATA IS ADDED BY THE showData() JAVASCRIPT FUNCTION ABOVE -->
				</table>
			</div>
		</div>
		<script>
			getSheet();
			async function getSheet() {
				try {
					const res = await fetch(
						"https://script.google.com/macros/s/AKfycbx8bnJgld4OQYGbSPlfY50RAZdn_FekwyXDE0pNXBcy5ly5k2vQFdpe7rmOzs1iaEXh/exec"
					);

					const data = await res.json();

					createTable(data);
				} catch (error) {
					console.log(error);
				}
			}

			function createTable(data) {
				const theTable = document.getElementById("data-table");
				data.forEach((row) => {
					const tableRow = document.createElement("tr");
					tableRow.classList = "first:font-semibold";
					row.forEach((rowData) => {
						const tableColoumn = document.createElement("td");
						tableColoumn.classList = " text-gray-600";
						tableColoumn.textContent = rowData;
						tableRow.appendChild(tableColoumn);
					});
					theTable.appendChild(tableRow);
				});
			}
		</script>
	</body>
</html>
